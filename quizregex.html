<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Quiz Regex (DAW) ‚Äî Validaciones de formularios (40 preguntas)</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#121b2e;
      --muted:#93a4c7;
      --text:#e8eeff;
      --accent:#6aa6ff;
      --ok:#35d07f;
      --bad:#ff5a7a;
      --warn:#ffcc66;
      --border:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 30% 10%, rgba(106,166,255,.25), transparent 60%),
                  radial-gradient(1000px 700px at 80% 30%, rgba(53,208,127,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      padding: 14px;
      align-items:flex-start;
      justify-content:center;
    }
    .app{
      width: min(920px, 100%);
      display:grid;
      gap:12px;
    }
    header{
      background: rgba(18,27,46,.85);
      border:1px solid var(--border);
      border-radius:16px;
      padding:14px 14px 12px;
      backdrop-filter: blur(8px);
    }
    h1{
      margin:0 0 6px 0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size: 13px;
      line-height:1.35;
    }
    .row{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      color: var(--muted);
    }
    .pill strong{color:var(--text); font-weight:700}
    .progress{
      flex: 1 1 260px;
      height:10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      overflow:hidden;
      min-width:240px;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(106,166,255,.9), rgba(53,208,127,.85));
      border-radius:999px;
      transition: width .25s ease;
    }
    .card{
      background: rgba(18,27,46,.88);
      border:1px solid var(--border);
      border-radius:16px;
      padding:14px;
      backdrop-filter: blur(8px);
    }
    .qhead{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .qnum{
      font-size:12px;
      color: var(--muted);
    }
    .qtitle{
      margin:6px 0 0 0;
      font-size: 16px;
      line-height:1.35;
    }
    .hint{
      margin:10px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height:1.35;
      border-left:3px solid rgba(106,166,255,.7);
      padding-left:10px;
    }
    .choices{
      display:grid;
      gap:10px;
      margin-top:12px;
    }
    button.choice{
      width:100%;
      text-align:left;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--text);
      padding:12px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size: 14px;
      line-height:1.25;
      transition: transform .03s ease, background .2s ease, border-color .2s ease;
      touch-action: manipulation;
    }
    button.choice:active{transform: scale(.99)}
    button.choice:hover{background: rgba(255,255,255,.05)}
    .choice code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12.5px;
      color:#d7e5ff;
    }
    .feedback{
      margin-top:12px;
      border-radius:14px;
      border:1px solid var(--border);
      padding:12px;
      display:none;
    }
    .feedback.ok{border-color: rgba(53,208,127,.45); background: rgba(53,208,127,.08)}
    .feedback.bad{border-color: rgba(255,90,122,.45); background: rgba(255,90,122,.08)}
    .feedback .t{
      margin:0 0 6px 0;
      font-weight:800;
      letter-spacing:.2px;
    }
    .feedback .e{
      margin:0;
      color: var(--text);
      line-height:1.45;
      font-size: 13.5px;
    }
    .actions{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:center;
    }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--text);
      padding:11px 12px;
      border-radius:12px;
      cursor:pointer;
      font-size: 14px;
      touch-action: manipulation;
    }
    .btn.primary{
      background: rgba(106,166,255,.16);
      border-color: rgba(106,166,255,.35);
    }
    .btn:disabled{
      opacity:.55;
      cursor:not-allowed;
    }
    .tiny{
      color:var(--muted);
      font-size:12px;
    }
    .summary{
      display:none;
    }
    .sumgrid{
      display:grid;
      gap:10px;
    }
    .sumcard{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius:14px;
      padding:12px;
    }
    .sumcard h3{
      margin:0 0 6px;
      font-size:14px;
    }
    .sumcard p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
    }
    .tag{
      display:inline-block;
      padding:3px 8px;
      border-radius:999px;
      font-size:12px;
      margin-left:8px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color:var(--muted);
    }
    .tag.ok{border-color: rgba(53,208,127,.45); color: rgba(53,208,127,.9)}
    .tag.bad{border-color: rgba(255,90,122,.45); color: rgba(255,90,122,.95)}
    .code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 12.5px;
      color:#d7e5ff;
      background: rgba(0,0,0,.15);
      padding:2px 6px;
      border-radius:8px;
      border:1px solid var(--border);
      display:inline-block;
      margin-top:6px;
      white-space: nowrap;
      max-width: 100%;
      overflow-x: auto;
    }
    @media (max-width:520px){
      .qtitle{font-size:15px}
      button.choice{padding:11px}
      header{padding:12px}
      .card{padding:12px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Quiz de Regex (DAW) ‚Äî Validaci√≥n de formularios</h1>
      <p class="sub">
        40 preguntas de menos a m√°s. Modo m√≥vil friendly. Te muestra explicaci√≥n al responder.
        En validaci√≥n, recuerda: casi siempre <span class="code">^</span> y <span class="code">$</span>, y evita <span class="code">g</span> con <span class="code">test()</span>.
      </p>
      <div class="row">
        <div class="progress" aria-label="Progreso">
          <div class="bar" id="bar"></div>
        </div>
        <div class="pill"><strong id="score">0</strong> aciertos</div>
        <div class="pill"><strong id="pos">1</strong>/40</div>
      </div>
    </header>

    <section class="card" id="quiz">
      <div class="qhead">
        <div>
          <div class="qnum" id="qnum">Pregunta 1</div>
          <h2 class="qtitle" id="qtext"></h2>
        </div>
        <div class="pill" id="topic">Tema</div>
      </div>

      <div class="choices" id="choices"></div>

      <div class="feedback" id="fb">
        <p class="t" id="fbt"></p>
        <p class="e" id="fbe"></p>
      </div>

      <div class="actions">
        <button class="btn" id="prev">‚¨ÖÔ∏è Anterior</button>
        <div class="tiny" id="tiny"></div>
        <button class="btn primary" id="next" disabled>Siguiente ‚û°Ô∏è</button>
      </div>
    </section>

    <section class="card summary" id="summary">
      <div class="qhead">
        <div>
          <div class="qnum">Resultado</div>
          <h2 class="qtitle" id="sumTitle"></h2>
          <p class="hint" id="sumHint"></p>
        </div>
        <div class="pill"><strong id="sumScore">0</strong>/40</div>
      </div>

      <div class="sumgrid" id="review"></div>

      <div class="actions">
        <button class="btn" id="restart">üîÅ Repetir quiz</button>
        <span class="tiny">Consejo: repite las falladas y reescribe el patr√≥n correcto en un papel.</span>
      </div>
    </section>
  </div>

<script>
  // 40 preguntas: de f√°cil (buscar/entender) a dif√≠cil (validaci√≥n real, opciones, grupos, email/tel√©fono).
  // Todas est√°n orientadas a validaci√≥n t√≠pica de formularios.
  const questions = [
    // 1‚Äì8: fundamentos (buscar vs validar, \d, clases)
    {
      topic:"Fundamentos",
      q:"¬øQu√© devuelve <code>/DAW/.test('Curso DAW 2')</code>?",
      choices:["false","true","Error: falta la bandera g","Depende del navegador"],
      a:1,
      e:"Sin <code>^</code> ni <code>$</code>, la regex busca dentro del texto. Como aparece ‚ÄúDAW‚Äù, devuelve <b>true</b>."
    },
    {
      topic:"Fundamentos",
      q:"¬øQu√© significa <code>\\d</code> en JavaScript regex?",
      choices:["Cualquier letra","Cualquier d√≠gito 0‚Äì9","Cualquier espacio en blanco","Cualquier car√°cter"],
      a:1,
      e:"<code>\\d</code> es un atajo para un d√≠gito (<code>[0-9]</code>)."
    },
    {
      topic:"Fundamentos",
      q:"¬øQu√© hace <code>[abc]</code>?",
      choices:["Coincide con la palabra ‚Äúabc‚Äù completa","Coincide con una sola letra: a o b o c","Coincide con cualquier letra menos a,b,c","Coincide con ‚Äúa‚Äù seguido de ‚Äúbc‚Äù"],
      a:1,
      e:"Los corchetes definen una clase de caracteres: aqu√≠, <b>un solo car√°cter</b> entre a/b/c."
    },
    {
      topic:"Fundamentos",
      q:"¬øQu√© devuelve <code>/\\d/.test('abc')</code>?",
      choices:["true","false","Error: \\d solo funciona con bandera u","Depende si hay espacios"],
      a:1,
      e:"No hay ning√∫n d√≠gito en ‚Äúabc‚Äù, as√≠ que <b>false</b>."
    },
    {
      topic:"Fundamentos",
      q:"¬øQu√© devuelve <code>/\\d+/.test('Tel: 6 1 2')</code>?",
      choices:["false","true","Error: + no se puede usar con \\d","true solo si hay 3 n√∫meros seguidos"],
      a:1,
      e:"<code>\\d+</code> busca ‚Äúuna o m√°s cifras seguidas‚Äù. En el texto aparece ‚Äú6‚Äù, ‚Äú1‚Äù, ‚Äú2‚Äù (al menos una secuencia), as√≠ que <b>true</b>."
    },
    {
      topic:"Fundamentos",
      q:"Para validar un campo completo (no solo buscar dentro), ¬øqu√© sueles usar?",
      choices:["Solo la bandera g","Anclas <code>^</code> y <code>$</code>","La bandera i","Corchetes [] siempre"],
      a:1,
      e:"En validaci√≥n de formulario casi siempre necesitas <code>^</code> (inicio) y <code>$</code> (final)."
    },
    {
      topic:"Fundamentos",
      q:"¬øQu√© valida <code>/^\\d+$/.test('123a')</code>?",
      choices:["true, porque contiene n√∫meros","false, porque hay una letra","true si hay 3 d√≠gitos al principio","false solo si termina en letra"],
      a:1,
      e:"<code>^</code> y <code>$</code> exigen que todo sea d√≠gitos. Como hay ‚Äúa‚Äù, es <b>false</b>."
    },
    {
      topic:"Fundamentos",
      q:"¬øCu√°l es el cuantificador que permite ‚Äúcero o m√°s‚Äù repeticiones?",
      choices:["<code>+</code>","<code>*</code>","<code>?</code>","<code>{n}</code>"],
      a:1,
      e:"<code>*</code> significa 0 o m√°s. Por eso permite cadena vac√≠a en patrones como <code>^\\d*$</code>."
    },

    // 9‚Äì16: cuantificadores, anclas, escapes
    {
      topic:"Cuantificadores",
      q:"¬øQu√© devuelve <code>/^\\d*$/.test('')</code>?",
      choices:["false","true","Error: * no permite vac√≠o","true solo con bandera g"],
      a:1,
      e:"<code>*</code> permite 0 repeticiones, y con <code>^...$</code> la cadena vac√≠a cumple. Resultado: <b>true</b>."
    },
    {
      topic:"Cuantificadores",
      q:"¬øQu√© devuelve <code>/^\\d{3}$/.test('1234')</code>?",
      choices:["true","false","true si empieza por 123","Depende de la bandera i"],
      a:1,
      e:"<code>{3}</code> exige exactamente 3 d√≠gitos. ‚Äú1234‚Äù tiene 4, por eso <b>false</b>."
    },
    {
      topic:"Cuantificadores",
      q:"¬øQu√© significa <code>\\d{3,}</code>?",
      choices:["Exactamente 3 d√≠gitos","Entre 3 y 9 d√≠gitos","3 o m√°s d√≠gitos","0 a 3 d√≠gitos"],
      a:2,
      e:"<code>{3,}</code> significa m√≠nimo 3, sin m√°ximo. Es decir, <b>3 o m√°s</b>."
    },
    {
      topic:"Cuantificadores",
      q:"¬øQu√© significa <code>\\d{2,4}</code>?",
      choices:["2 o 4 d√≠gitos (solo esos)","Entre 2 y 4 d√≠gitos","Exactamente 24 d√≠gitos","2 d√≠gitos seguidos de 4 d√≠gitos"],
      a:1,
      e:"<code>{2,4}</code> indica un rango: m√≠nimo 2 y m√°ximo 4."
    },
    {
      topic:"Escape",
      q:"En regex, el punto <code>.</code> significa‚Ä¶",
      choices:["Punto literal","Cualquier car√°cter (excepto salto de l√≠nea)","Final de cadena","Espacio en blanco"],
      a:1,
      e:"<code>.</code> es comod√≠n. Si quieres punto literal, usa <code>\\.</code>."
    },
    {
      topic:"Escape",
      q:"¬øCu√°l busca literalmente ‚Äú.com‚Äù al final?",
      choices:["<code>/.com$/</code>","<code>/\\.com$/</code>","<code>/com\\.$/</code>","<code>/\\.com^/</code>"],
      a:1,
      e:"Hay que escapar el punto: <code>\\.</code>, y usar <code>$</code> para el final."
    },
    {
      topic:"Grupos",
      q:"¬øPara qu√© sirven los par√©ntesis <code>( )</code> en regex (principalmente)?",
      choices:["Para elegir un solo car√°cter como [ ]","Para agrupar y aplicar cuantificadores/alternativas a un bloque","Para convertir la regex en global","Para ignorar may√∫sculas"],
      a:1,
      e:"Los par√©ntesis agrupan: permiten repetir bloques <code>(ab)+</code> o hacer alternativas <code>(com|es)</code>."
    },
    {
      topic:"Grupos",
      q:"¬øCu√°l coincide con el texto literal ‚Äú(612)‚Äù?",
      choices:["<code>/(612)/</code>","<code>/\\(612\\)/</code>","<code>/[612]/</code>","<code>/^612$/</code>"],
      a:1,
      e:"Para par√©ntesis literales hay que escaparlos: <code>\\(</code> y <code>\\)</code>."
    },

    // 17‚Äì24: validaciones t√≠picas (n√∫meros, letras, alfanum√©rico, longitud)
    {
      topic:"Validaci√≥n",
      q:"Regex para validar ‚Äúsolo n√∫meros (1 o m√°s)‚Äù en un campo:",
      choices:["<code>/\\d+/</code>","<code>/^\\d+$/</code>","<code>/\\d{1}$/</code>","<code>/[0-9]*/</code>"],
      a:1,
      e:"Para validar todo el campo: <code>^</code> inicio + <code>\\d+</code> + <code>$</code> fin."
    },
    {
      topic:"Validaci√≥n",
      q:"Regex para validar ‚Äúexactamente 9 d√≠gitos‚Äù (tel√©fono simple):",
      choices:["<code>/\\d{9}/</code>","<code>/^\\d{9}$/</code>","<code>/^\\d{9,}$/</code>","<code>/\\d{9}$/</code>"],
      a:1,
      e:"Sin anclas podr√≠a encontrar 9 d√≠gitos dentro de texto. Para validaci√≥n estricta: <code>^\\d{9}$</code>."
    },
    {
      topic:"Validaci√≥n",
      q:"Regex para validar ‚Äúsolo letras (sin espacios), may√∫s/min√∫s indiferente‚Äù:",
      choices:["<code>/^[a-z]$/i</code>","<code>/^[a-z]+$/i</code>","<code>/[a-z]+/</code>","<code>/^[A-Z]+$/</code>"],
      a:1,
      e:"<code>+ </code> es clave: una o m√°s letras. Sin <code>+</code> validas solo una letra."
    },
    {
      topic:"Validaci√≥n",
      q:"Regex para validar ‚Äúletras y n√∫meros (sin s√≠mbolos), m√≠nimo 5 caracteres‚Äù:",
      choices:["<code>/^[a-z0-9]{5,}$/i</code>","<code>/^[a-z]{5,}$/i</code>","<code>/^\\w{5,}$/</code>","<code>/[a-z0-9]{5,}/i</code>"],
      a:0,
      e:"<code>^[a-z0-9]{5,}$</code> valida alfanum√©rico, m√≠nimo 5. <code>\\w</code> incluye ‚Äú_‚Äù, cuidado."
    },
    {
      topic:"Validaci√≥n",
      q:"¬øCu√°l valida ‚Äúusuario entre 5 y 12 alfanum√©ricos‚Äù (sin guiones ni _) ?",
      choices:["<code>/^[a-z0-9]{5,12}$/i</code>","<code>/^[a-z0-9]+$/i</code>","<code>/^[a-z0-9]{5,}$/i</code>","<code>/^\\w{5,12}$/</code>"],
      a:0,
      e:"La clave es el rango <code>{5,12}</code> y evitar <code>\\w</code> si no quieres guion bajo."
    },
    {
      topic:"Validaci√≥n",
      q:"¬øCu√°l valida ‚Äúempieza por JS‚Äù (y luego cualquier cosa)?",
      choices:["<code>/JS/</code>","<code>/^JS/</code>","<code>/JS$/</code>","<code>/^JS$/</code>"],
      a:1,
      e:"<code>^JS</code> asegura que empieza por JS. Sin <code>^</code> solo busca dentro."
    },
    {
      topic:"Validaci√≥n",
      q:"¬øCu√°l valida ‚Äútermina en .com‚Äù?",
      choices:["<code>/\\.com$/</code>","<code>/\\.com^/</code>","<code>/.com$/</code>","<code>/com\\.$/</code>"],
      a:0,
      e:"Punto escapado + final con <code>$</code>."
    },
    {
      topic:"Validaci√≥n",
      q:"Regex para validar ‚Äúc√≥digo: JS + exactamente 4 d√≠gitos‚Äù (ej: JS2026):",
      choices:["<code>/^JS\\d{4}$/</code>","<code>/JS\\d{4}/</code>","<code>/^JS\\d+$/</code>","<code>/^JS{4}\\d$/</code>"],
      a:0,
      e:"Se valida todo el campo: <code>^JS</code> + <code>\\d{4}</code> + <code>$</code>."
    },

    // 25‚Äì30: tel√©fono con reglas, prefijo, opcionalidad, alternancias
    {
      topic:"Tel√©fono",
      q:"Tel√©fono espa√±ol que empiece por 6 o 7 y tenga 9 d√≠gitos:",
      choices:["<code>/^[67]\\d{8}$/</code>","<code>/^\\d{9}$/</code>","<code>/^[67]\\d{9}$/</code>","<code>/^([67])\\d{7}$/</code>"],
      a:0,
      e:"El primer d√≠gito (6 o 7) + 8 d√≠gitos m√°s = 9 en total."
    },
    {
      topic:"Tel√©fono",
      q:"Prefijo opcional +34 (con o sin espacio) + 9 d√≠gitos:",
      choices:[
        "<code>/^(\\+34\\s?)?\\d{9}$/</code>",
        "<code>/^(34)*\\d{9}$/</code>",
        "<code>/^\\+34?\\d{9}$/</code>",
        "<code>/^(\\+34|34)?\\d{9}$/g</code>"
      ],
      a:0,
      e:"<code>(\\+34\\s?)?</code> hace opcional el prefijo, y <code>\\d{9}</code> valida el n√∫mero. Evita <code>g</code> en <code>test()</code>."
    },
    {
      topic:"Tel√©fono",
      q:"Si el tel√©fono es opcional: ¬øqu√© l√≥gica es correcta en JS?",
      choices:[
        "Si est√° vac√≠o ‚Üí OK; si no, validar con regex",
        "Siempre validar, aunque est√© vac√≠o",
        "Usar <code>*</code> para permitir cualquier cosa",
        "Quitar <code>^</code> y <code>$</code> para que pase m√°s"
      ],
      a:0,
      e:"Patr√≥n t√≠pico: <b>si vac√≠o, no errores</b>. Si tiene contenido, entonces <code>regex.test(valor)</code>."
    },
    {
      topic:"Tel√©fono",
      q:"Quieres limpiar un tel√©fono con guiones/espacios/par√©ntesis y quedarte solo con d√≠gitos. ¬øQu√© regex usar√≠as con <code>replace</code>?",
      choices:["<code>/\\d/g</code>","<code>/\\D/g</code>","<code>/^\\d+$/</code>","<code>/[0-9]{9}/</code>"],
      a:1,
      e:"<code>\\D</code> = ‚Äúno d√≠gito‚Äù. Reemplazando <code>\\D</code> por vac√≠o te quedas solo con n√∫meros."
    },
    {
      topic:"Tel√©fono",
      q:"¬øCu√°l es correcta para permitir <b>34</b> o <b>+34</b> opcional antes de 9 d√≠gitos (sin espacio)?",
      choices:[
        "<code>/^(\\+34|34)?\\d{9}$/</code>",
        "<code>/^\\+?34\\d{9}$/</code>",
        "<code>/^(34|\\+34)*\\d{9}$/</code>",
        "<code>/^(\\+34||34)?\\d{9}$/</code>"
      ],
      a:0,
      e:"Alternativa con <code>|</code> dentro de un grupo y opcional con <code>?</code>."
    },
    {
      topic:"Tel√©fono",
      q:"¬øPor qu√© se recomienda NO usar la bandera <code>g</code> con <code>test()</code> para validar formularios?",
      choices:[
        "Porque rompe el DOM",
        "Porque <code>test()</code> con <code>g</code> puede depender de <code>lastIndex</code> y dar resultados raros",
        "Porque <code>g</code> desactiva <code>^</code> y <code>$</code>",
        "Porque <code>g</code> solo funciona con n√∫meros"
      ],
      a:1,
      e:"Con <code>g</code>, algunas operaciones actualizan <code>lastIndex</code>, lo que puede alternar true/false en llamadas sucesivas."
    },

    // 31‚Äì40: email progresivo y casos t√≠picos de examen
    {
      topic:"Email",
      q:"Email ‚Äúclase‚Äù b√°sico (solo letras) con validaci√≥n completa:",
      choices:[
        "<code>/^[a-z]+@[a-z]+\\.[a-z]+$/i</code>",
        "<code>/[a-z]+@[a-z]+\\.[a-z]+/i</code>",
        "<code>/^[a-z]@[a-z]\\.com$/i</code>",
        "<code>/^\\w+@\\w+\\.\\w+$/</code>"
      ],
      a:0,
      e:"La opci√≥n A valida todo el campo. La B solo busca dentro. <code>\\w</code> incluye ‚Äú_‚Äù, ojo."
    },
    {
      topic:"Email",
      q:"¬øPor qu√© hay que escribir <code>\\.</code> en un email en lugar de <code>.</code>?",
      choices:[
        "Porque <code>.</code> es el final del string",
        "Porque <code>.</code> significa ‚Äúcualquier car√°cter‚Äù, y queremos un punto literal",
        "Porque <code>.</code> solo funciona con bandera s",
        "Porque los puntos no existen en emails"
      ],
      a:1,
      e:"<code>.</code> es comod√≠n. Para un punto literal debes escapar: <code>\\.</code>."
    },
    {
      topic:"Email",
      q:"Permitir puntos antes de la @ (juan.perez.lopez@...) en el usuario:",
      choices:[
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9]+\\.[a-z]+$/i</code>",
        "<code>/^[a-z0-9]+\\.[a-z0-9]+@[a-z]+\\.[a-z]+$/i</code>",
        "<code>/^[a-z0-9]*(\\.[a-z0-9]*)*@/i</code>",
        "<code>/^[a-z0-9]+(\\.[a-z0-9])?@[a-z]+\\.[a-z]+$/i</code>"
      ],
      a:0,
      e:"<code>(\\.[a-z0-9]+)*</code> permite 0 o m√°s bloques ‚Äú.algo‚Äù."
    },
    {
      topic:"Email",
      q:"Limitar la extensi√≥n a com/es/org (solo esas):",
      choices:[
        "<code>/\\.(com|es|org)$/</code>",
        "<code>/\\.(com||es||org)$/</code>",
        "<code>/\\.(com|es|org)^/</code>",
        "<code>/\\.(com,es,org)$/</code>"
      ],
      a:0,
      e:"En regex la alternativa es <code>|</code> (no <code>||</code>), y se usa <code>$</code> para final."
    },
    {
      topic:"Email",
      q:"Email con puntos antes de @, dominio con n√∫meros, extensi√≥n com/es/org:",
      choices:[
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9]+\\.(com|es|org)$/i</code>",
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9]+\\.(com|es|org)$/ig</code>",
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9]\\.com$/i</code>",
        "<code>/^[a-z0-9]+\\.?@[a-z0-9]+\\.(com|es|org)$/i</code>"
      ],
      a:0,
      e:"La A es la forma limpia. Evita <code>g</code> con <code>test()</code>. La C solo permite 1 car√°cter de dominio."
    },
    {
      topic:"Email",
      q:"Permitir guiones en el dominio (mi-empresa.com): parte de dominio correcta es‚Ä¶",
      choices:[
        "<code>[a-z0-9-]+</code>",
        "<code>[a-z0-9]+(-[a-z0-9]+)*</code>",
        "<code>-[a-z0-9]+</code>",
        "<code>[a-z0-9]+(-)*</code>"
      ],
      a:1,
      e:"La opci√≥n B evita que el dominio empiece o termine con guion: bloque repetible ‚Äú-algo‚Äù."
    },
    {
      topic:"Email",
      q:"Email ‚ÄúDAW avanzado‚Äù (usuario con puntos, dominio con guiones, extensi√≥n limitada):",
      choices:[
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9]+(-[a-z0-9]+)*\\.(com|es|org)$/i</code>",
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@[a-z0-9-]+\\.(com|es|org)$/i</code>",
        "<code>/^[a-z0-9\\.]+@[a-z0-9\\-]+\\.(com|es|org)$/i</code>",
        "<code>/^[a-z0-9]+(\\.[a-z0-9]+)*@(-[a-z0-9]+)*\\.(com|es|org)$/i</code>"
      ],
      a:0,
      e:"La A es la forma estructurada y segura: evita doble punto/guion mal colocado. La B y C son m√°s permisivas."
    },
    {
      topic:"Examen",
      q:"¬øQu√© m√©todo es el m√°s t√≠pico para validar con regex en formularios (devuelve true/false)?",
      choices:["<code>match()</code>","<code>replace()</code>","<code>test()</code>","<code>search()</code>"],
      a:2,
      e:"Para validar y decidir ‚Äúpasa/no pasa‚Äù, lo t√≠pico es <code>regex.test(valor)</code>."
    },
    {
      topic:"Examen",
      q:"Quieres marcar un campo inv√°lido con borde rojo al enviar. Lo m√°s limpio es‚Ä¶",
      choices:[
        "Cambiar estilos inline en 10 sitios",
        "Crear clase CSS <code>.error</code> y a√±adir/quitar con <code>classList</code>",
        "Usar solo alert()",
        "Quitar <code>required</code> del HTML"
      ],
      a:1,
      e:"Patr√≥n DAW: CSS con <code>.error</code> y en JS <code>element.classList.add('error')</code> / <code>remove</code>."
    },
    {
      topic:"Examen",
      q:"En un <code>submit</code> de formulario, ¬øqu√© haces para evitar el env√≠o real mientras validas?",
      choices:[
        "<code>event.stopPropagation()</code>",
        "<code>event.preventDefault()</code>",
        "<code>return false</code> siempre",
        "No hace falta nada"
      ],
      a:1,
      e:"En el listener de <code>submit</code>, lo t√≠pico es <code>event.preventDefault()</code> para validar y decidir."
    },

    // 40: pregunta final integradora (elige la mejor)
    {
      topic:"Final",
      q:"Elige la mejor validaci√≥n para: <b>tel√©fono opcional</b> (si hay texto, debe ser 9 d√≠gitos empezando por 6 o 7).",
      choices:[
        "JS: <code>if (!/^[67]\\d{8}$/.test(tel)) error;</code>",
        "JS: <code>if (tel !== '' && !/^[67]\\d{8}$/.test(tel)) error;</code>",
        "JS: <code>if (/^[67]\\d{8}$/.test(tel) === false) ok;</code>",
        "JS: <code>if (tel === '' || /^[67]\\d{8}$/.test(tel)) error;</code>"
      ],
      a:1,
      e:"Como es opcional: si est√° vac√≠o, OK. Si no est√° vac√≠o, validas. Por eso: <code>tel !== '' && !regex.test(tel)</code>."
    }
  ];

  // State
  let idx = 0;
  let score = 0;
  const answers = Array(questions.length).fill(null); // chosen index
  const correctness = Array(questions.length).fill(null); // true/false

  const elBar = document.getElementById('bar');
  const elScore = document.getElementById('score');
  const elPos = document.getElementById('pos');
  const elQnum = document.getElementById('qnum');
  const elQtext = document.getElementById('qtext');
  const elTopic = document.getElementById('topic');
  const elChoices = document.getElementById('choices');
  const elFb = document.getElementById('fb');
  const elFbt = document.getElementById('fbt');
  const elFbe = document.getElementById('fbe');
  const elPrev = document.getElementById('prev');
  const elNext = document.getElementById('next');
  const elTiny = document.getElementById('tiny');

  const elQuiz = document.getElementById('quiz');
  const elSummary = document.getElementById('summary');
  const elSumTitle = document.getElementById('sumTitle');
  const elSumHint = document.getElementById('sumHint');
  const elSumScore = document.getElementById('sumScore');
  const elReview = document.getElementById('review');
  const elRestart = document.getElementById('restart');

  function setProgress() {
    const p = ((idx) / questions.length) * 100;
    elBar.style.width = p.toFixed(2) + '%';
    elPos.textContent = (idx + 1);
    elScore.textContent = String(score);
  }

  function renderQuestion() {
    setProgress();
    const q = questions[idx];

    elQnum.innerHTML = `Pregunta ${idx + 1} de ${questions.length}`;
    elTopic.textContent = q.topic;
    elQtext.innerHTML = q.q;

    // Reset feedback
    elFb.style.display = 'none';
    elFb.classList.remove('ok','bad');
    elFbt.textContent = '';
    elFbe.textContent = '';

    // Render choices
    elChoices.innerHTML = '';
    q.choices.forEach((c, i) => {
      const btn = document.createElement('button');
      btn.className = 'choice';
      btn.type = 'button';
      btn.innerHTML = c;
      btn.addEventListener('click', () => selectChoice(i));
      elChoices.appendChild(btn);
    });

    // Prev/Next state
    elPrev.disabled = (idx === 0);
    elNext.disabled = (answers[idx] === null);
    elTiny.textContent = answers[idx] === null
      ? 'Responde para desbloquear ‚ÄúSiguiente‚Äù.'
      : 'Puedes cambiar tu respuesta; se recalcula la puntuaci√≥n.';

    // If already answered, show feedback and highlight
    if (answers[idx] !== null) {
      showFeedback(answers[idx]);
      highlight(answers[idx]);
    }
  }

  function highlight(chosen) {
    const q = questions[idx];
    const btns = [...elChoices.querySelectorAll('button.choice')];
    btns.forEach((b, i) => {
      b.style.borderColor = 'rgba(255,255,255,.10)';
      b.style.background = 'rgba(255,255,255,.03)';
    });
    // chosen
    btns[chosen].style.borderColor = 'rgba(106,166,255,.55)';
    btns[chosen].style.background = 'rgba(106,166,255,.10)';
    // correct (subtle)
    btns[q.a].style.borderColor = 'rgba(53,208,127,.55)';
  }

  function selectChoice(choiceIdx) {
    const q = questions[idx];
    const prevChoice = answers[idx];
    const wasCorrectBefore = correctness[idx];

    answers[idx] = choiceIdx;
    const isCorrectNow = (choiceIdx === q.a);
    correctness[idx] = isCorrectNow;

    // Update score if changing an already answered question
    if (prevChoice === null) {
      if (isCorrectNow) score++;
    } else {
      // If previously correct and now incorrect => score--
      if (wasCorrectBefore && !isCorrectNow) score--;
      // If previously incorrect and now correct => score++
      if (!wasCorrectBefore && isCorrectNow) score++;
    }

    elNext.disabled = false;
    elTiny.textContent = 'Puedes cambiar tu respuesta; se recalcula la puntuaci√≥n.';
    elScore.textContent = String(score);

    highlight(choiceIdx);
    showFeedback(choiceIdx);
  }

  function showFeedback(choiceIdx) {
    const q = questions[idx];
    const ok = (choiceIdx === q.a);
    elFb.style.display = 'block';
    elFb.classList.remove('ok','bad');
    elFb.classList.add(ok ? 'ok' : 'bad');
    elFbt.textContent = ok ? '‚úÖ Correcto' : '‚ùå Incorrecto';
    const correctHtml = q.choices[q.a].includes('<code>')
      ? `Respuesta correcta: ${q.choices[q.a]}`
      : `Respuesta correcta: <b>${q.choices[q.a]}</b>`;
    elFbe.innerHTML = `${correctHtml}<br><br>${q.e}`;
  }

  function next() {
    if (idx < questions.length - 1) {
      idx++;
      renderQuestion();
    } else {
      finish();
    }
  }

  function prev() {
    if (idx > 0) {
      idx--;
      renderQuestion();
    }
  }

  function finish() {
    // Fill progress to 100%
    elBar.style.width = '100%';

    elQuiz.style.display = 'none';
    elSummary.style.display = 'block';

    elSumScore.textContent = String(score);
    elSumTitle.textContent = `Tu resultado: ${score} aciertos de ${questions.length}`;
    const percent = Math.round((score / questions.length) * 100);
    let msg = '';
    if (percent >= 90) msg = 'Nivel muy alto. Ya est√°s para examen con confianza.';
    else if (percent >= 75) msg = 'Buen nivel. Repasa especialmente las falladas y repite el quiz.';
    else if (percent >= 55) msg = 'Vas bien, pero conviene repetir fundamentos: ^ $, + * ?, escapes y alternancias.';
    else msg = 'Repite desde las primeras preguntas y practica 10 minutos al d√≠a: te sube r√°pido.';
    elSumHint.textContent = msg;

    // Review list
    elReview.innerHTML = '';
    questions.forEach((q, i) => {
      const card = document.createElement('div');
      card.className = 'sumcard';

      const ok = (correctness[i] === true);
      const tag = `<span class="tag ${ok ? 'ok' : 'bad'}">${ok ? 'OK' : 'FALLADA'}</span>`;
      const chosen = answers[i] === null ? '‚Äî' : q.choices[answers[i]];
      const correct = q.choices[q.a];

      card.innerHTML = `
        <h3>${i + 1}. ${q.topic} ${tag}</h3>
        <p><b>Pregunta:</b> ${q.q}</p>
        <p style="margin-top:8px"><b>Tu respuesta:</b> ${chosen}</p>
        <p style="margin-top:6px"><b>Correcta:</b> ${correct}</p>
        <p style="margin-top:8px">${q.e}</p>
      `;
      elReview.appendChild(card);
    });
  }

  function restart() {
    idx = 0;
    score = 0;
    for (let i=0;i<answers.length;i++){
      answers[i] = null;
      correctness[i] = null;
    }
    elScore.textContent = '0';
    elPos.textContent = '1';
    elBar.style.width = '0%';
    elQuiz.style.display = 'block';
    elSummary.style.display = 'none';
    renderQuestion();
  }

  elNext.addEventListener('click', next);
  elPrev.addEventListener('click', prev);
  elRestart.addEventListener('click', restart);

  // Keyboard (optional): 1-4 select, Enter next
  document.addEventListener('keydown', (e) => {
    if (elSummary.style.display === 'block') return;
    if (e.key >= '1' && e.key <= '4') {
      const n = parseInt(e.key,10)-1;
      if (n >= 0 && n < questions[idx].choices.length) selectChoice(n);
    }
    if (e.key === 'Enter' && !elNext.disabled) next();
  });

  renderQuestion();
</script>
</body>
</html>
